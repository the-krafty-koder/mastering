# URL Shortener

# Functional requirements

1. Should shorten urls given a long URL
2. Should redirect to original URL given a shortened URL

# Non functional requirements

1. High availability.
2. High scalability
3. Fault tolerance

# API Design

1. POST api/v1/shorten -> returns short url given a long url.
2. GET api/v1/shortURL -> return long URL for http redirect (301)

# Deep dive

1. Data model

- Store <shortURL, longURL> mapping in a relational DB.

2. Hash function

- Use base62 conversion to hash a long URL to a short one. It is better than hashing algos because collission is impossible because ID is unique

3.  Shortening flow

        Long URL ----> longURL in DB ------> return shortURL
                            |
                            |
                        Generate new ID
                            |
                            |
                        Convert new ID into short URL
                            |
                            |
                        Save ID, short URL, longURL in DB

1.  longURL is the input.
1.  The system checks if the longURL is in the database.
1.  If it is, it means the longURL was converted to shortURL before. In this case, fetch the
    shortURL from the database and return it to the client.
1.  If not, the longURL is new. A new unique ID (primary key) Is generated by the unique
    ID generator.
1.  Convert the ID to shortURL with base 62 conversion.
1.  Create a new database row with the ID, shortURL, and longURL.

1.  Redirection flow

        User ----> Load balancer -----> Web server
                                            |
                                            |
                                ------------ ----------
                                |                     |
                                >                     >
                            Cache                 Database


    1. A user clicks a short URL link: https://tinyurl.com/zn9edcu
    2. The load balancer forwards the request to web servers.
    3. If a shortURL is already in the cache, return the longURL directly.
    4. If a shortURL is not in the cache, fetch the longURL from the database. If it is not in the
       database, it is likely a user entered an invalid shortURL.
    5. The longURL is returned to the user.
